{% extends "base.html" %}

{% block title %}{{ diary.title }}{% endblock %}

{% block content %}

    <div class="d-flex justify-content-center">

        <div class="diary col-10" id="diary-element-{{ diary.pk }}">

            <div class="block block-header">
            <h4 class="pl-2 mb-0">{{ diary.title }}</h4>
            <p class="pl-2 text-muted m-0">
                <small>by @{{ diary.user.username }}</small>
            </p>
        </div>

        <div class="diary-page-body block p-3">

            <div class="diary-image d-flex justify-content-center">
                <!-- Стандартная картинка дневника -->
                {% if diary.photo %}
                    <div class="d-flex justify-content-center">
                        <div id="image-prev" class="p-3">
                            <!-- Стандартная картинка дневника -->
                            {% load staticfiles %}
                            <img src="{{ diary.photo.url }}" class="img-fluid m-1">
                        </div>
                    </div>
                {% else %}
                    {% load staticfiles %}
                    <div class="d-flex justify-content-center">
                        <div id="image-prev" class="p-3">
                            <!-- Стандартная картинка дневника -->
                            {% load staticfiles %}
                            <img src="{% static 'images/DefaultHouse.png' %}" class="img-fluid m-1">
                        </div>
                    </div>
                {% endif %}
            </div>
            <div class="row justify-content-around">
                <div class="shadow p-2 bg-white rounded col-4">
                    <p class="m-1"><strong>Date start:</strong> {{ diary.date_start }} </p>
                    <p class="m-1"><strong>Date finish:</strong> {{ diary.date_finish }} </p>
                    <p class="m-1"><strong>Status:</strong>
                        {% if diary.is_active %}
                            <span class="text-success">Active</span>
                        {% elif diary.is_frozen %}
                            <span class="text-info">Frozen</span>
                        {% else %}
                            <span class="text-secondary">Finished</span>
                        {% endif %}
                    </p>

                </div>
                <div class="shadow p-2 bg-white rounded col-7">
                    <h5>About</h5>
                    <p>{{ diary.about }}</p>
                </div>
            </div>

        </div>

            <div class="map-block block">
                {% include 'UserProfile/includes/map_diary_page.html' %}
            </div>

            <div class="row d-flex justify-content-center p-0">
                <div class="col-12">
                    {% for note in notes reversed %}
                        {% include 'UserProfile/note_block.html' %}
                    {% endfor %}
            </div>
            </div>
            <div class="col-12 block block-footer d-flex justify-content-center">
                {% if is_owner %}
                    <form>
                        <button type="button"
                                class="delete-element btn btn-danger ml-2" id="delete-element-{{ diary.pk }}">
                            Delete
                        </button>
                        <button type="button" formaction="/diary/edit/{{ diary.pk }}/"
                                class="btn btn-warning ml-2" id="edit-element-{{ diary.pk }}">
                            Edit
                        </button>
                    </form>
                    {% if diary.is_active or diary.is_frozen %}
                        <button id="finish-diary" class="btn btn-warning ml-2" data-toggle="modal"
                                data-target="#myModal">
                            Finish
                        </button>
                        {% if diary.is_active %}
                            <span class="text-success">Active</span>
                        {% elif diary.is_frozen %}
                            <button id="frozen-diary">Activate</button>
                        {% endif %}
                    {% endif %}
                {% endif %}
            </div>


        </div> <!-- diary-element -->

    </div>

    {% include 'UserProfile/includes/modal_diary_finish.html' %}

{% endblock %}


{% block script %}

    {% load staticfiles %}
    <script src="{% static '/js/js.cookie.js' %}"></script>
    <script src="{% static '/js/ajax_csrf.js' %}"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCJPcRk7BvJ-3SzCmd_culJXrMUJJn7xBY&callback=initMap"
            async defer></script>



{% endblock %}